<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OpenIllumination</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap-4.4.1.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script type="text/javascript" src="js/custom.js"></script>

</head>

<body>
<h2 id="obj_property">ID: %s Name: %s Material: %s</h2>
<br>
<button type="button" class="btn btn-primary" onclick="goBack()">Main</button>
<button type="button" class="btn btn-primary" onclick="goToPreviousObject()">Previous Object</button>
<button type="button" class="btn btn-primary" onclick="goToNextObject()">Next Object</button>
<br>
<br>
Light
<button id="light001" type="button" class="btn btn-primary" onclick="goToLight('001')">001</button>
<button id="light002" type="button" class="btn btn-primary" onclick="goToLight('002')">002</button>
<button id="light003" type="button" class="btn btn-primary" onclick="goToLight('003')">003</button>
<button id="light004" type="button" class="btn btn-primary" onclick="goToLight('004')">004</button>
<button id="light005" type="button" class="btn btn-primary" onclick="goToLight('005')">005</button>
<button id="light006" type="button" class="btn btn-primary" onclick="goToLight('006')">006</button>
<button id="light007" type="button" class="btn btn-primary" onclick="goToLight('007')">007</button>
<button id="light008" type="button" class="btn btn-primary" onclick="goToLight('008')">008</button>
<button id="light009" type="button" class="btn btn-primary" onclick="goToLight('009')">009</button>
<button id="light010" type="button" class="btn btn-primary" onclick="goToLight('010')">010</button>
<button id="light011" type="button" class="btn btn-primary" onclick="goToLight('011')">011</button>
<button id="light012" type="button" class="btn btn-primary" onclick="goToLight('012')">012</button>
<button id="light013" type="button" class="btn btn-warning" onclick="goToLight('013')">013</button>
<br><br>
<br>
Mask Type
<button id="button_masked_obj" type="button" class="btn btn-warning" onclick="goToMask('obj_masked_thumbnail')">Object
    mask
</button>
<button id="button_masked_com" type="button" class="btn btn-primary" onclick="goToMask('com_masked_thumbnail')">Combined
    mask
</button>
<button id="button_origin" type="button" class="btn btn-primary" onclick="goToMask('origin_thumbnail')">No mask
</button>
<br><br>
<div id="imgdiv"></div>
</body>
<script>
    const objectId = new URLSearchParams(window.location.search).get('id');
    maxN = 0
    fetch('data.json')
        .then(response => response.json())
        .then(data => {
            maxN = Object.keys(data['obj_list']).length;
            updateContent(data);
        })
        .catch(error => console.error(error));


    function parse(str) {
        var args = [].slice.call(arguments, 1),
            i = 0;

        return str.replace(/%s/g, () => args[i++]);
    }

    function updateContent(data) {
        obj_list = data['obj_list'];
        imgid_list = data['imgid_list'];
        const thisdata = obj_list[objectId - 1]
        // console.log(thisdata)
        const img_container = document.getElementById('imgdiv');
        //const root = "/mnt/data/OpenIllumination_release"
        const root="https://huggingface.co/datasets/fsky097/OpenIllumination/resolve/main/lighting_patterns"
        https://huggingface.co/datasets/fsky097/OpenIllumination/resolve/main/lighting_patterns/obj_43_paper_ball/Lights/001/obj_masked_thumbnail/CA2.png
        imgid_list.forEach(imgid => {
            const img = document.createElement('img');
            img.src = `${root}/${thisdata['data_name']}/Lights/013/obj_masked_thumbnail/${imgid}.png`
            img.style.maxWidth = '8%'
            img_container.appendChild(img)
            //const label = document.createElement('label');
            //label.innerHTML = imgid
            //img_container.appendChild(label)
        })
        const display_name = thisdata["display_name"];
        const material = thisdata["material"];
        obj_property = document.getElementById("obj_property");
        obj_property.innerHTML = `ID: ${objectId} Name: ${display_name} Material: ${material}`;
    }

    function goToNextObject() {
        // console.log('maxN', maxN)
        const currentIndex = parseInt(objectId);
        if (currentIndex === maxN) {
            return
        }
        const nextIndex = Math.min((currentIndex + 1), maxN); // Calculate the index of the next object

        // Construct the URL with the next object's ID
        const nextUrl = `obj.html?id=${nextIndex.toString()}`;

        // Navigate to the next URL
        window.location.href = nextUrl;
    }

    function goToPreviousObject() {
        const currentIndex = parseInt(objectId);
        if (currentIndex === 1) {
            return
        }
        const previousIndex = Math.max(1, (currentIndex - 1)); // Calculate the index of the previous object

        // Construct the URL with the previous object's ID
        const previousUrl = `obj.html?id=${previousIndex.toString()}`;

        // Navigate to the previous URL
        window.location.href = previousUrl;
    }


</script>
</html>
